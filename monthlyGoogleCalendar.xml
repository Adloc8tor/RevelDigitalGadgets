<?xml version="1.0" encoding="UTF-8"?>
<Module>
  <ModulePrefs title="RevelDigital Google Calendar Gadget" description="Lists your current Google Calendar events in chronological order" author="Adloc8tor" background="transparent">
  	<Locale messages="https://adloc8tor.github.io/RevelDigitalGadgets/monthlyGoogleCalendar.lang.xml"/>
  	<UserPref name="apiKey" display_name="Google Developer Key" datatype="string" />
  	<UserPref name="calendarID" display_name="Google Calendar ID" datatype="string" />

	<UserPref name="calendarHeadingStyle" display_name="Calendar Heading Style" datatype="style" required="true" default-value="font-family:'Arial';font-size:14px;color:#fff;" />
	<UserPref name="calendarHeadingBackground" display_name="Calendar Heading Background" datatype="string" required="true" />
	
	<UserPref name="dayOfWeekStyle" display_name="Day Of The Week Style" datatype="style" required="true" />
	<UserPref name="dayOfWeekBackground" display_name="Day Of The Week Background" datatype="string" required="true" />
	
	<UserPref name="dayNumberStyle" display_name="Day Number Style" datatype="style" required="true" />

	<UserPref name="borderColor" display_name="Calendar Border Color" datatype="string" required="true" />
	
	<UserPref name="eventStyle" display_name="Event Style" datatype="style" required="true" />
	<UserPref name="eventBackground" display_name="Event Background" datatype="string" required="true" />
  </ModulePrefs>
  <Content type="html">
<![CDATA[

<style type="text/css">
body *
{
  line-height: 1.2em; 
  letter-spacing: 0; 
  word-spacing: normal;
}

body
{
  overflow: hidden;
  background: transparent;
}

img
{
  float: left;
  width: 200px;
  margin-right: 10px;
}

/* Table Headings */
.fc .fc-toolbar .fc-center {
  __UP_calendarHeadingStyle__
  background-color: __UP_calendarHeadingBackground__;
  text-align:center;
}

.fc-day-header {
  __UP_dayOfWeekStyle__;
  background-color: __UP_dayOfWeekBackground__;
}

.fc-day-number {
  background-color:transparent;
  __UP_dayNumberStyle__;
}

.fc-day {
  background-color: transparent;
  __UP_dayOfWeekStyle__;
}

.fc-unthemed th,
.fc-unthemed td,
.fc-unthemed thead,
.fc-unthemed tbody,
.fc-unthemed .fc-divider,
.fc-unthemed .fc-row,
.fc-unthemed .fc-content {
	border: 1px solid __UP_borderColor__;
}

.fc-unthemed .fc-divider {
	background: __UP_borderColor__;
}

.fc-bgevent { /* default look for background events */
	background: rgb(143, 223, 130);
	opacity: .3;
	filter: alpha(opacity=30); /* for IE */
}

.fc-nonbusiness { /* default look for non-business-hours areas */
	/* will inherit .fc-bgevent's styles */
	background: #d7d7d7;
}

.fc-divider {
	border-style: solid;
	border-width: 1px;
}

hr.fc-divider {
	height: 0;
	margin: 0;
	padding: 0 0 2px; /* height is unreliable across browsers, so use padding */
	border-width: 1px 0;
}

.fc-clear {
	clear: both;
}

.fc-bg,
.fc-bgevent-skeleton,
.fc-highlight-skeleton,
.fc-helper-skeleton {
	/* these element should always cling to top-left/right corners */
	position: absolute;
	top: 0;
	left: 0;
	right: 0;
}

.fc-bg {
	bottom: 0; /* strech bg to bottom edge */
}

.fc-bg table {
	height: 100%; /* strech bg to bottom edge */
}

/* Tables
--------------------------------------------------------------------------------------------------*/

.fc table {
	width: 100%;
	table-layout: fixed;
	border-collapse: collapse;
	border-spacing: 0;
	font-size: 1em; /* normalize cross-browser */
}

.fc th {
	text-align: center;
}

.fc th,
.fc td {
	border-style: solid;
	border-width: 1px;
	padding: 0;
	vertical-align: top;
}

.fc td.fc-today {
	border-style: double; /* overcome neighboring borders */
}


/* Fake Table Rows
--------------------------------------------------------------------------------------------------*/

.fc .fc-row { /* extra precedence to overcome themes w/ .ui-widget-content forcing a 1px border */
	/* no visible border by default. but make available if need be (scrollbar width compensation) */
	border-style: solid;
	border-width: 0;
}

.fc-row table {
	/* don't put left/right border on anything within a fake row.
	   the outer tbody will worry about this */
	border-left: 0 hidden transparent;
	border-right: 0 hidden transparent;

	/* no bottom borders on rows */
	border-bottom: 0 hidden transparent; 
}

.fc-row:first-child table {
	border-top: 0 hidden transparent; /* no top border on first row */
}

/* Global Event Styles
--------------------------------------------------------------------------------------------------*/

.fc-event,
.fc-event:hover,
.ui-widget .fc-event {
	position: relative; /* for resize handle and other inner positioning */
	display: block; /* make the <a> tag block */
	font-size: .85em;
	line-height: 1.3;
	border-radius: 3px;
	border: 1px solid __UP_eventBackground__;
	background-color: __UP_eventBackground__;
	__UP_eventStyle__;
}

.fc-event[href],
.fc-event.fc-draggable {
	cursor: pointer; /* give events with links and draggable events a hand mouse pointer */
}

.fc-not-allowed, /* causes a "warning" cursor. applied on body */
.fc-not-allowed .fc-event { /* to override an event's custom cursor */
	cursor: not-allowed;
}

.fc-event .fc-bg { /* the generic .fc-bg already does position */
	z-index: 1;
	background: #fff;
	opacity: .25;
	filter: alpha(opacity=25); /* for IE */
}

.fc-event .fc-content {
	position: relative;
	z-index: 2;
}

/* resizer (cursor AND touch devices) */

.fc-event .fc-resizer {
	position: absolute;
	z-index: 4;
}

/* resizer (touch devices) */

.fc-event .fc-resizer {
	display: none;
}

.fc-event.fc-allow-mouse-resize .fc-resizer,
.fc-event.fc-selected .fc-resizer {
	/* only show when hovering or selected (with touch) */
	display: block;
}

/* Utilities
--------------------------------------------------------------------------------------------------*/

.fc-unselectable {
	-webkit-user-select: none;
	 -khtml-user-select: none;
	   -moz-user-select: none;
	    -ms-user-select: none;
	        user-select: none;
	-webkit-touch-callout: none;
	-webkit-tap-highlight-color: rgba(0, 0, 0, 0);
}

/* View Structure
--------------------------------------------------------------------------------------------------*/

/* undo twitter bootstrap's box-sizing rules. normalizes positioning techniques */
/* don't do this for the toolbar because we'll want bootstrap to style those buttons as some pt */
.fc-view-container *,
.fc-view-container *:before,
.fc-view-container *:after {
	-webkit-box-sizing: content-box;
	   -moz-box-sizing: content-box;
	        box-sizing: content-box;
}

.fc-view, /* scope positioning and z-index's for everything within the view */
.fc-view > table { /* so dragged elements can be above the view's main element */
	position: relative;
	z-index: 1;
}

</style>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js" type="text/javascript"></script>
<script src="https://reveldigital.github.io/reveldigital-gadgets/third-party/moment-with-langs.min.js" type="text/javascript"></script>
<script src="https://reveldigital.github.io/reveldigital-gadgets/third-party/moment-timezone-with-data.js" type="text/javascript"></script>
<script src="https://reveldigital.github.io/reveldigital-gadgets/third-party/simpledateformat.js" type="text/javascript"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/1.18.4/TweenLite.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/1.18.4/utils/Draggable.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/1.18.4/plugins/CSSPlugin.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/1.18.4/plugins/ScrollToPlugin.min.js"></script>
<script src="https://reveldigital.github.io/reveldigital-gadgets/third-party/autoscroll.js" type="text/javascript"></script>
<script src="https://reveldigital.github.io/gadget-common/utils.js" type="text/javascript"></script>
<script src="https://www.google.com/jsapi" type="text/javascript"></script>

<script src="https://adloc8tor.github.io/RevelDigitalGadgets/javascripts/fullcalendar.js"></script>
<script src="https://adloc8tor.github.io/RevelDigitalGadgets/javascripts/gcal.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/webfont/1.5.18/webfont.js"></script>

<div id="calendar">
</div>

<script type="text/javascript">

  var prefs = new gadgets.Prefs();
  
  function load() {
    
    WebFont.load({
      google: {
        families: [
          RevelDigital.getFamilyName(prefs.getString("header-style"))
        ]
      }
    });
    WebFont.load({
      google: {
        families: [
          RevelDigital.getFamilyName(prefs.getString("body-style"))
        ]
      }
    });
    
    moment.lang("__MSG_Lang__");
    
    if (typeof Client != "undefined" && typeof(Client.getDeviceTimeZoneName) == "function") {
      moment.tz.setDefault(Client.getDeviceTimeZoneName());
    }
   
   	// Update the content on the screen every 2 minutes.
   	update();
   	setInterval(update, 120000);
   }

  gadgets.util.registerOnLoadHandler(load);
</script>

<script type="text/javascript">
  
  function update() {
  
	$('#calendar').fullCalendar({
        // put your options and callbacks here
        googleCalendarApiKey: prefs.getString("apiKey"), //'AIzaSyDN8dkir1si9vMwWJYz64YCsUIhFustgL8',
        events: {
           googleCalendarId: prefs.getString("calendarID"), //'graeme@adloc8tor.com'
        },
        header: {
          left: '',
          center: 'title',
          right:'',
        },
        eventLimit: true, // for all non-agenda views
        views: {
          agenda: {
            eventLimit: 6 // adjust to 6 only for agendaWeek/agendaDay
          }
        }
//TODO: Append a description of the event if it exists.
//        eventRender: function(event, element)
//	{
//    	  element.find('.fc-title').append("<br/>" + event.description); 
//	}
    });
    
  }

</script>

]]>
</Content></Module>
